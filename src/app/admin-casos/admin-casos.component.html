<header class="seccion1">
    <div><app-admin-menu></app-admin-menu></div>
</header>

<section class="tabla-abogados-container">
    <h1>Casos del Abogado</h1>

    <div *ngIf="!isLoggedIn" class="mensaje-sesion">
        <h1>Debes iniciar sesión primero.</h1>
    </div>

    <div *ngIf="isLoggedIn">
        <!-- Mensaje si no hay casos disponibles -->
        <div *ngIf="noCasosAvailable" class="mensaje-no-casos">
            <h2>No hay casos disponibles.</h2>
        </div>

        <div *ngFor="let caso of casos" class="caso-container">
            <h2>Caso ID: {{ caso.id }}</h2>
            <div class="abogado-info">
                <div class="info-item">
                    <strong>Abogado Encargado:</strong> {{ caso.id_abogado_encargado }}
                </div>
                <div class="info-item">
                    <strong>Identificador del Cliente:</strong> {{ caso.id_cliente }}
                </div>
                <div class="info-item">
                    <strong>Estado del Caso:</strong> {{ caso.estado_caso }}
                </div>
                <div class="info-item">
                    <strong>Descripción del Caso:</strong> {{ caso.descripcion_caso }}
                </div>
                <div class="info-item">
                    <strong>Evidencias:</strong> {{ caso.evidencia }}
                </div>
                <div class="info-item">
                    <strong>Testimonios:</strong> {{ caso.testimonios }}
                </div>
                <div class="info-item">
                    <strong>Se creó:</strong> {{ caso.creado_en }}
                </div>
                <div class="info-item">
                    <strong>Se actualizó:</strong> {{ caso.actualizado_en }}
                </div>
                <div class="info-item">
                    <strong>Rama:</strong> {{ caso.rama_id }}
                </div>
            </div>
        </div>
        <br>

        <!-- Botón para abrir el formulario de nuevo caso -->
        <button (click)="abrirFormularioCaso()" class="info-item">Crear Nuevo Caso</button>

        <!-- Formulario para crear un nuevo caso -->
        <div *ngIf="formularioVisible" class="formulario-caso" id="formulario-caso">
          <h2>Crear Nuevo Caso</h2>
            <form (ngSubmit)="crearCaso()" id="nuevo-caso-form">
                
                <!-- Correo del Cliente -->
                <div class="form-group">
                    <label for="correo_cliente">Correo del Cliente:</label>
                    <input type="email" id="correo_cliente" [(ngModel)]="correoCliente" name="correo_cliente" class="info-item" required>
                    <button type="button" (click)="buscarCliente()" class="info-itemguardar">Buscar Cliente</button>
                </div>
        
                <!-- ID del Cliente -->
                <div class="form-group">
                    <label for="id_cliente">ID del Cliente:</label>
                    <input type="text" id="id_cliente" [(ngModel)]="nuevoCaso.id_cliente" name="id_cliente" class="info-item" readonly required>
                </div>
        
                <!-- ID del Abogado Encargado -->
                <div class="form-group">
                    <label for="id_abogado">Abogado Encargado:</label>
                    <select id="id_abogado" [(ngModel)]="nuevoCaso.id_abogado_encargado" name="id_abogado" class="info-item" required>
                    <option value="" disabled selected>Selecciona un abogado</option>
                    <option *ngFor="let abogado of abogados" [value]="abogado.id">{{ abogado.nombre }}</option>
                    </select>
                </div>
                
                <!-- Estado del Caso -->
                <div class="form-group">
                    <label for="estado_caso">Estado del Caso</label>
                    <select id="estado_caso" [(ngModel)]="nuevoCaso.estado_caso" name="estado_caso" class="info-item" required>
                        <option value="abierto">Abierto</option>
                        <option value="finalizado">Finalizado</option>
                    </select>
                </div>
        
                <!-- Descripción del Caso -->
                <div class="form-group">
                    <label for="descripcion_caso">Descripción del Caso:</label>
                    <textarea id="descripcion_caso" [(ngModel)]="nuevoCaso.descripcion_caso" name="descripcion_caso" class="info-item" rows="4" required></textarea>
                </div>
        
                <!-- Evidencias -->
                <div class="form-group">
                    <label for="evidencia">Evidencias:</label>
                    <textarea id="evidencia" [(ngModel)]="nuevoCaso.evidencia" name="evidencia" class="info-item" rows="3" required></textarea>
                </div>
        
                <!-- Testimonios -->
                <div class="form-group">
                    <label for="testimonios">Testimonios:</label>
                    <textarea id="testimonios" [(ngModel)]="nuevoCaso.testimonios" name="testimonios" class="info-item" rows="3" required></textarea>
                </div>
        
                <!-- Rama del Derecho -->
                <div class="form-group">
                    <label for="rama_id">Rama del Derecho</label>
                    <select id="rama_id" [(ngModel)]="nuevoCaso.rama_id" name="rama_id" class="info-item" required>
                        <option value="" disabled selected>Selecciona tu especialización</option>
                        <option value="1">Derecho Civil</option>
                        <option value="2">Derecho Penal</option>
                        <option value="3">Derecho Administrativo</option>
                        <option value="4">Derecho Laboral</option>
                        <option value="5">Derecho Comercial</option>
                        <option value="6">Derecho Internacional</option>
                        <option value="7">Derecho Constitucional</option>
                        <option value="8">Derecho Ambiental</option>
                    </select>
                    
                </div>
        
                <!-- Botón para enviar -->
                <button type="submit" class="info-itemguardar" id="boton-guardar">Guardar Caso</button>
            </form>
        </div>
        

    </div>

    <!-- Botón para volver a Admin Principal -->
    <br><button (click)="volverAdminPrincipal()" class="info-item">Volver a Admin Principal</button>
</section>

<footer>
    <app-footer></app-footer>
</footer>
